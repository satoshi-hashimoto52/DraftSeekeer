# Security & Privacy

## 要約
- 図面画像は機密情報を含む可能性があります。
- 保存先は `data/` 配下のローカルファイルです。
- 出力パスは絶対パスのみ許可です。
- SAM checkpoint パスはコード/環境変数に含まれます。
- ログに画像内容は出力しませんが、エラー時にパスが出る可能性があります。
- CORS は `*` 許可であり、運用時は制限が必要です。
- 断定できない箇所は【要確認】として明記します。
- 変更時は API と UI の両方に影響します。
- 目的は「取り扱い注意点の明文化」です。
- 詳細は [runbook](runbook.md) を参照してください。

## 目次
- [取り扱いデータ](#取り扱いデータ)
- [保存先](#保存先)
- [ログ/マスキング](#ログマスキング)
- [権限/鍵/パス管理](#権限鍵パス管理)
- [CORS/外部接続](#cors外部接続)
- [運用時の推奨](#運用時の推奨)

## 取り扱いデータ
- 図面画像: 設計情報が含まれる可能性がある
- テンプレ画像: 記号の定義を含む
- アノテーション: 設計属性を示すデータ

## 保存先
- `data/datasets/<project>/images`: 生画像
- `data/datasets/<project>/annotations`: アノテJSON
- `data/templates`: テンプレ
- `data/images`: UI 作業用コピー
- `data/runs`: export ダウンロード用

## ログ/マスキング
- アプリは画像内容をログ出力しない
- 例外ログにパスが出る可能性あり
- 共有環境ではログ出力先を制限する

## 権限/鍵/パス管理
- `SAM_CHECKPOINT` の絶対パスがコードに存在
- 運用時は環境変数で上書き推奨
- `output_dir` は絶対パスのみ許可

## CORS/外部接続
- 現在 `allow_origins = ["*"]`
- 運用時は UI ドメインに限定すべき

## 運用時の推奨
- `data/` 配下をバックアップ
- 外部共有前に `data/` をマスキング
- `data/templates` は機密配布扱いにする
